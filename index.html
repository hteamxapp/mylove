<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ƒê·∫øm Ng√†y Y√™u</title>
  <style>
    :root {
      --main-color: #ff80ab;
      --secondary-color: #ce93d8;
      --text-dark: #333;
      --text-light: #fff;
      --badge-bg: #fce4ec;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      color: var(--text-dark);
    }
    .overlay {
      background: rgba(255, 255, 255, 0.85);
      min-height: 100vh;
      padding: 30px 20px;
      position: relative;
      backdrop-filter: blur(10px);
    }
    .top-buttons {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 10px;
    }
    .top-buttons button {
      padding: 6px 10px;
      font-size: 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .title {
      font-size: 24px;
      text-align: center;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .circle {
      width: 260px;
      height: 260px;
      margin: 20px auto;
      position: relative;
    }
    .circle svg {
      transform: rotate(-90deg);
    }
    .circle .center-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
    }
    .center-text .label {
      font-size: 18px;
      color: var(--text-dark);
    }
    .center-text .days {
      font-size: 48px;
      font-weight: bold;
    }
    .center-text .unit {
      font-size: 14px;
    }
    .profiles {
      display: flex;
      justify-content: space-around;
      align-items: center;
      margin-top: 30px;
    }
    .profile {
      text-align: center;
    }
    .avatar-wrapper {
      border-radius: 50%;
      padding: 3px;
      background: linear-gradient(135deg, var(--main-color), var(--secondary-color));
      display: inline-block;
    }
    .avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid white;
    }
    .nickname {
      font-size: 16px;
      font-weight: bold;
      margin-top: 8px;
    }
    .tags {
      margin-top: 4px;
      display: flex;
      justify-content: center;
      gap: 5px;
      flex-wrap: wrap;
    }
    .tag {
      font-size: 12px;
      background: var(--badge-bg);
      padding: 3px 6px;
      border-radius: 12px;
      display: inline-flex;
      align-items: center;
      gap: 3px;
    }
    .tag.male { background: #e1f5fe; }
    .tag.female { background: #fce4ec; }
    .heart {
      font-size: 24px;
      color: var(--main-color);
      margin: 0 10px;
    }
  </style>
</head>
<body>
<div class="overlay">
  <div class="top-buttons">
    <button onclick="toggleEdit()">‚úèÔ∏è</button>
    <button onclick="toggleSettings()">‚öôÔ∏è</button>
  </div>
  <div class="title">üíñ ƒê·∫øm Ng√†y Y√™u üíñ</div>
  <div class="circle">
    <svg width="260" height="260">
      <circle cx="130" cy="130" r="120" stroke="#eee" stroke-width="10" fill="none" />
      <circle id="progressCircle" cx="130" cy="130" r="120" stroke="url(#grad1)" stroke-width="10" fill="none" stroke-dasharray="754" stroke-dashoffset="754" stroke-linecap="round"/>
      <defs>
        <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" style="stop-color:#f48fb1;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#ce93d8;stop-opacity:1" />
        </linearGradient>
      </defs>
    </svg>
    <div class="center-text">
      <div class="label" id="label">B√°m nhau</div>
      <div class="days" id="daysCount">0</div>
      <div class="unit">Ng√†y</div>
    </div>
  </div>
  <div class="profiles">
    <div class="profile">
      <div class="avatar-wrapper">
        <img id="avatar1" class="avatar" src="">
      </div>
      <div class="nickname" id="name1">C√°nh c·ª•t c·ª•t c√°nh üêß</div>
      <div class="tags" id="tags1"></div>
    </div>
    <div class="heart">‚ù§Ô∏è</div>
    <div class="profile">
      <div class="avatar-wrapper">
        <img id="avatar2" class="avatar" src="">
      </div>
      <div class="nickname" id="name2">Kh·ªßng long kh·ªßng l·ªì ü¶ñ</div>
      <div class="tags" id="tags2"></div>
    </div>
  </div>
</div>

<!-- Nh√∫ng 2 ph·∫ßn ch·ªânh s·ª≠a & c√†i ƒë·∫∑t -->
<div id="setting-container"></div>
<div id="edit-container"></div>

<script>
  // ‚úÖ fetch ƒë√∫ng chu·∫©n ƒë·ªÉ d√πng tr√™n GitHub Pages
  fetch("./setting.html")
    .then(res => res.text())
    .then(html => document.getElementById("setting-container").innerHTML = html);

  fetch("./edit.html")
    .then(res => res.text())
    .then(html => document.getElementById("edit-container").innerHTML = html);
</script>

<script>
function toggleEdit() {
  document.getElementById('editOverlay').style.display = 'flex';
  document.getElementById('editLabel').value = document.getElementById('label').textContent;
  document.getElementById('editName1').value = document.getElementById('name1').textContent;
  document.getElementById('editName2').value = document.getElementById('name2').textContent;
}
function uploadImg(e, id) {
  const reader = new FileReader();
  reader.onload = function(evt) {
    document.getElementById(id).src = evt.target.result;
    localStorage.setItem(id, evt.target.result);
  };
  reader.readAsDataURL(e.target.files[0]);
}
function getZodiac(d, m) {
  const signs = ["Ma K·∫øt", "B·∫£o B√¨nh", "Song Ng∆∞", "B·∫°ch D∆∞∆°ng", "Kim Ng∆∞u", "Song T·ª≠", "C·ª± Gi·∫£i", "S∆∞ T·ª≠", "X·ª≠ N·ªØ", "Thi√™n B√¨nh", "B·ªç C·∫°p", "Nh√¢n M√£"];
  const symbols = ["‚ôë", "‚ôí", "‚ôì", "‚ôà", "‚ôâ", "‚ôä", "‚ôã", "‚ôå", "‚ôç", "‚ôé", "‚ôè", "‚ôê"];
  const last = [19,18,20,20,20,21,22,22,22,23,22,21];
  let i = (d > last[m-1]) ? m : m-1;
  if (i < 0) i = 11;
  return { name: signs[i], symbol: symbols[i] };
}
function saveEdit() {
  const label = document.getElementById('editLabel').value;
  const name1 = document.getElementById('editName1').value;
  const name2 = document.getElementById('editName2').value;
  const gender1 = document.getElementById('editGender1').value;
  const gender2 = document.getElementById('editGender2').value;
  const birth1 = new Date(document.getElementById('editBirth1').value);
  const birth2 = new Date(document.getElementById('editBirth2').value);
  const now = new Date();
  const age1 = now.getFullYear() - birth1.getFullYear();
  const age2 = now.getFullYear() - birth2.getFullYear();
  const z1 = getZodiac(birth1.getDate(), birth1.getMonth() + 1);
  const z2 = getZodiac(birth2.getDate(), birth2.getMonth() + 1);
  document.getElementById('label').textContent = label;
  document.getElementById('name1').textContent = name1;
  document.getElementById('name2').textContent = name2;
  document.getElementById('tags1').innerHTML = `<div class='tag ${gender1}'>${gender1 === 'male' ? '‚ôÇÔ∏è' : '‚ôÄÔ∏è'} ${age1}</div><div class='tag'>${z1.symbol} ${z1.name}</div>`;
  document.getElementById('tags2').innerHTML = `<div class='tag ${gender2}'>${gender2 === 'male' ? '‚ôÇÔ∏è' : '‚ôÄÔ∏è'} ${age2}</div><div class='tag'>${z2.symbol} ${z2.name}</div>`;
  localStorage.setItem('label', label);
  localStorage.setItem('name1', name1);
  localStorage.setItem('name2', name2);
  localStorage.setItem('gender1', gender1);
  localStorage.setItem('gender2', gender2);
  localStorage.setItem('birth1', document.getElementById('editBirth1').value);
  localStorage.setItem('birth2', document.getElementById('editBirth2').value);
  document.getElementById('editOverlay').style.display = 'none';
}
function toggleSettings() {
  const p = document.getElementById("settings-panel");
  p.style.display = p.style.display === "none" ? "block" : "none";
}
function applySettings() {
  document.body.setAttribute("data-theme", document.getElementById("themeToggle").checked ? "light" : "");
  if (document.getElementById("flowerToggle").checked) launchEffect("üå∏");
  if (document.getElementById("heartToggle").checked) launchEffect("‚ù§Ô∏è");
  document.getElementById("settings-panel").style.display = "none";
}
function launchEffect(icon) {
  setInterval(() => {
    const el = document.createElement("div");
    el.className = "effect";
    el.style.left = Math.random() * 100 + "%";
    el.textContent = icon;
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 6000);
  }, 400);
}
function updateDays() {
  const loveDate = new Date(localStorage.getItem('loveDate') || '2024-08-01');
  const now = new Date();
  const days = Math.floor((now - loveDate) / (1000 * 60 * 60 * 24));
  document.getElementById('daysCount').textContent = days;
  const percent = (days % 365) / 365;
  const offset = 754 * (1 - percent);
  document.getElementById('progressCircle').style.strokeDashoffset = offset;
}
function loadData() {
  ['label','name1','name2'].forEach(id => {
    if (localStorage.getItem(id)) document.getElementById(id).textContent = localStorage.getItem(id);
  });
  if (localStorage.getItem('avatar1')) document.getElementById('avatar1').src = localStorage.getItem('avatar1');
  if (localStorage.getItem('avatar2')) document.getElementById('avatar2').src = localStorage.getItem('avatar2');
  if (localStorage.getItem('birth1')) document.getElementById('editBirth1').value = localStorage.getItem('birth1');
  if (localStorage.getItem('birth2')) document.getElementById('editBirth2').value = localStorage.getItem('birth2');
  if (localStorage.getItem('gender1')) document.getElementById('editGender1').value = localStorage.getItem('gender1');
  if (localStorage.getItem('gender2')) document.getElementById('editGender2').value = localStorage.getItem('gender2');
  if (localStorage.getItem('birth1') && localStorage.getItem('gender1')) {
    const b1 = new Date(localStorage.getItem('birth1'));
    const age1 = new Date().getFullYear() - b1.getFullYear();
    const z1 = getZodiac(b1.getDate(), b1.getMonth() + 1);
    const g1 = localStorage.getItem('gender1');
    document.getElementById('tags1').innerHTML = `<div class='tag ${g1}'>${g1 === 'male' ? '‚ôÇÔ∏è' : '‚ôÄÔ∏è'} ${age1}</div><div class='tag'>${z1.symbol} ${z1.name}</div>`;
  }
  if (localStorage.getItem('birth2') && localStorage.getItem('gender2')) {
    const b2 = new Date(localStorage.getItem('birth2'));
    const age2 = new Date().getFullYear() - b2.getFullYear();
    const z2 = getZodiac(b2.getDate(), b2.getMonth() + 1);
    const g2 = localStorage.getItem('gender2');
    document.getElementById('tags2').innerHTML = `<div class='tag ${g2}'>${g2 === 'male' ? '‚ôÇÔ∏è' : '‚ôÄÔ∏è'} ${age2}</div><div class='tag'>${z2.symbol} ${z2.name}</div>`;
  }
  updateDays();
}
window.onload = loadData;
</script>
</body>
</html>
